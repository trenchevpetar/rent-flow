import{d as x,C as g,u as L,I as R,Q as G,a as $,c as b,w as Z,b as d,r as C,o as m,t as _,e as N,f as P,g as U,F as D,h as n,i as c,_ as w,j as B,k as i,l as j,m as S,n as J,p as E,q as W,s as O,v as A,x as F,y as X,z as Y,A as ee,B as V,D as T}from"./index-DmdCqFOg.js";import{_ as te,a as M,T as q,b as Q,c as ne,u as oe,F as se}from"./FloatingBar-Bj9_dMT6.js";async function ae(a){try{return(await x.listDocuments(g.DATABASE_ID,g.COLLECTIONS.INCOME,[G.equal("propertyId",a)])).documents}catch(e){throw console.log("error fetching incomes"),e}}async function le(a){var l;const o=(l=L().currentUser)==null?void 0:l.$id;try{return await x.createDocument(g.DATABASE_ID,g.COLLECTIONS.INCOME,R.unique(),{...a,propertyId:o})}catch(t){console.log(t)}}async function ie(a){try{await x.deleteDocument(g.DATABASE_ID,g.COLLECTIONS.INCOME,a)}catch(e){throw console.log(`Error deleting income with id: ${a}`),e}}const re={class:"fieldset w-full"},ce={class:"flex w-full justify-end gap-2 mt-2"},de={type:"submit",class:"btn btn-primary"},z=$({__name:"BasicForm",props:{submitLabel:{},cancelLabel:{}},emits:["on-submit","on-cancel"],setup(a,{emit:e}){const o=e,l=()=>o("on-submit"),t=()=>o("on-cancel");return(u,p)=>(m(),b("form",{onSubmit:Z(l,["prevent"]),class:"flex justify-center align-center items-center"},[d("fieldset",re,[C(u.$slots,"default"),d("div",ce,[C(u.$slots,"actions",{},()=>[d("button",de,_(u.submitLabel),1),d("button",{type:"reset",class:"btn btn-soft",onClick:t},_(u.cancelLabel),1)])])])],32))}}),ue=$({__name:"AddIncomeForm",emits:["on-add-income","on-cancel"],setup(a,{emit:e}){const o=N(),l=e,t=P({propertyId:"",type:"",amount:0,datePaid:""}),{mutate:u,isPending:p}=U({mutationFn:le,onSuccess:()=>{o.invalidateQueries({queryKey:["incomes"]})}}),f=()=>{u(t.value),l("on-add-income")},h=()=>l("on-cancel");return(v,r)=>(m(),b(D,null,[n(z,{"submit-label":"Add Income","cancel-label":"Cancel",onOnSubmit:f,onOnCancel:h},{default:c(()=>[n(w,{modelValue:t.value.type,"onUpdate:modelValue":r[0]||(r[0]=s=>t.value.type=s),label:"Type",placeholder:"Type of income"},null,8,["modelValue"]),n(w,{modelValue:t.value.amount,"onUpdate:modelValue":r[1]||(r[1]=s=>t.value.amount=s),label:"Amount",placeholder:"Amount",type:"number"},null,8,["modelValue"]),n(te,{label:"Date paid",modelValue:t.value.datePaid,"onUpdate:modelValue":r[2]||(r[2]=s=>t.value.datePaid=s),type:"month"},null,8,["modelValue"])]),_:1}),n(B,{"is-loading":i(p)},null,8,["is-loading"])],64))}}),me={},pe={xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"size-12"};function _e(a,e){return m(),b("svg",pe,e[0]||(e[0]=[d("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M2.25 8.25h19.5M2.25 9h19.5m-16.5 5.25h6m-6 2.25h3m-3.75 3h15a2.25 2.25 0 0 0 2.25-2.25V6.75A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25v10.5A2.25 2.25 0 0 0 4.5 19.5Z"},null,-1)]))}const fe=j(me,[["render",_e]]),ye={class:"join"},be=$({__name:"ListIncomeActions",emits:["on-edit","on-delete"],setup(a,{emit:e}){const o=e,{t:l}=S(),t=()=>o("on-edit"),u=()=>o("on-delete");return(p,f)=>(m(),b("div",ye,[d("button",{class:"btn btn-info btn-xs join-item",onClick:t},_(i(l)("actions.edit")),1),d("button",{class:"btn btn-error btn-xs join-item",onClick:u},_(i(l)("actions.delete")),1)]))}});function ve(a){const e=J({queryKey:["incomes",a],queryFn:()=>ae(a),enabled:E(()=>!!a),staleTime:3e5});return{...e,refresh:()=>e.refetch()}}const he={},$e={class:"card bg-base-100 shadow-sm mb-4 border-2 border-white/20"},Ce={class:"card-body"},ge={class:"card-title"},Ie={class:"card-actions justify-end"};function we(a,e){return m(),b("div",$e,[d("div",Ce,[d("h2",ge,[C(a.$slots,"title")]),C(a.$slots,"default"),d("div",Ie,[C(a.$slots,"actions")])])])}const K=j(he,[["render",we]]),Ae={key:0,class:"list-incomes"},Ve={class:"title text-2xl mb-4"},De=$({__name:"ListIncomes",emits:["on-edit-income"],setup(a,{emit:e}){const o=W(),l=e,t=L(),u=E(()=>{var y;return((y=t.currentUser)==null?void 0:y.$id)||""}),{data:p,isPending:f,refetch:h}=ve(u.value),{t:v}=S(),r=y=>l("on-edit-income",y),s=async y=>{await oe({title:"Confirm deletion",message:"Are you sure you want to delete this income?",onConfirm:async()=>{await ie(y.$id),h()}})?await o.show("Deleted successfully","success"):await o.show("Deletion failed, try again later","warning")};return(y,k)=>i(p)&&i(p).length?(m(),b("section",Ae,[d("h1",Ve,_(i(v)("incomes.list")),1),i(f)?(m(),A(q,{key:0})):(m(),A(M,{key:1,class:"gap-4"},{default:c(()=>[(m(!0),b(D,null,F(i(p),I=>(m(),A(Q,{key:I.datePaid,size:12,responsive:{sm:12,md:6,lg:6}},{default:c(()=>[n(K,null,{default:c(()=>[n(ne,{title:I.type.toUpperCase(),value:I.amount},{image:c(()=>[n(fe)]),actions:c(()=>[n(be,{onOnDelete:H=>s(I),onOnEdit:H=>r(I)},null,8,["onOnDelete","onOnEdit"])]),_:2},1032,["title","value"])]),_:2},1024)]),_:2},1024))),128))]),_:1})),k[0]||(k[0]=d("div",{class:"divider"},null,-1))])):O("",!0)}}),Pe=$({__name:"AddPropertyForm",emits:["on-add-property","on-cancel"],setup(a,{emit:e}){const o=N(),l=e,t=P({name:"",location:"",ownerId:"",units:0}),{mutate:u,isPending:p}=U({mutationFn:X,onSuccess:()=>{o.invalidateQueries({queryKey:["ownerId"]})}}),f=()=>{u(t.value),l("on-add-property")},h=()=>l("on-cancel");return(v,r)=>(m(),b(D,null,[n(z,{"submit-label":"Add property","cancel-label":"Cancel",onOnSubmit:f,onOnCancel:h},{default:c(()=>[n(w,{modelValue:t.value.name,"onUpdate:modelValue":r[0]||(r[0]=s=>t.value.name=s),label:"Name",placeholder:"Name"},null,8,["modelValue"]),n(w,{modelValue:t.value.location,"onUpdate:modelValue":r[1]||(r[1]=s=>t.value.location=s),label:"Street name",placeholder:"Location"},null,8,["modelValue"]),n(w,{modelValue:t.value.units,"onUpdate:modelValue":r[2]||(r[2]=s=>t.value.units=s),type:"number",label:"Units (How many units this property have?)",placeholder:"How many units this property have?"},null,8,["modelValue"])]),_:1}),n(B,{"is-loading":i(p)},null,8,["is-loading"])],64))}}),Se={key:0,class:"list-properties"},ke={class:"title text-2xl mb-4"},Oe={class:"join mt-2"},xe=$({__name:"ListProperties",props:{isPresentational:{type:Boolean,default:!1}},setup(a){var f;const e=L(),{data:o,isPending:l}=Y("ownerId",((f=e.currentUser)==null?void 0:f.$id)??""),{t}=S(),u=a,p=E(()=>u.isPresentational?{sm:12,md:12,lg:12}:{sm:12,md:6,lg:4});return(h,v)=>{const r=ee("RouterLink");return i(o)&&i(o).length?(m(),b("section",Se,[d("h1",ke,_(i(t)("properties.added")),1),n(M,{class:"gap-4"},{default:c(()=>[(m(!0),b(D,null,F(i(o),s=>(m(),A(Q,{key:s.$id,size:12,responsive:p.value},{default:c(()=>[i(l)?(m(),A(q,{key:0})):O("",!0),n(K,null,{title:c(()=>[V(_(s.name),1)]),actions:c(()=>[C(h.$slots,"property-actions",{},()=>[d("div",Oe,[n(r,{to:`/property-categories/${s.$id}`,class:"btn btn-outline btn-sm join-item"},{default:c(()=>v[0]||(v[0]=[V(" Configure categories ")])),_:2,__:[0]},1032,["to"]),n(r,{to:`/property-details/${s.$id}`,class:"btn btn-outline btn-sm join-item"},{default:c(()=>[V(_(i(t)("expenses.check")),1)]),_:2},1032,["to"])])])]),default:c(()=>[d("ul",null,[d("li",null,_(i(t)("location"))+": "+_(s.location),1)])]),_:2},1024)]),_:2},1032,["responsive"]))),128))]),_:3}),v[1]||(v[1]=d("div",{class:"divider"},null,-1))])):O("",!0)}}}),Le={class:"title text-2xl mb-4"},Ne=$({__name:"DashboardPage",setup(a){const{t:e}=S(),o=P(!1),l=P(!1),t=()=>o.value=!0,u=()=>o.value=!1,p=()=>o.value=!1,f=()=>l.value=!0,h=()=>l.value=!1,v=()=>l.value=!1;return(r,s)=>(m(),b(D,null,[d("h1",Le,_(i(e)("dashboard")),1),n(xe),n(De),n(se,{actions:[{name:"property"},{name:"income"}],onProperty:t,onIncome:f},{property:c(()=>[V(_(i(e)("properties.add")),1)]),income:c(()=>[V(_(i(e)("income.add")),1)]),_:1}),n(T,{title:i(e)("properties.add"),modelValue:o.value,"onUpdate:modelValue":s[0]||(s[0]=y=>o.value=y)},{default:c(()=>[n(Pe,{onOnCancel:p,onOnAddProperty:u})]),_:1},8,["title","modelValue"]),n(T,{title:i(e)("income.add"),modelValue:l.value,"onUpdate:modelValue":s[1]||(s[1]=y=>l.value=y)},{default:c(()=>[n(ue,{onOnCancel:v,onOnAddIncome:h})]),_:1},8,["title","modelValue"])],64))}});export{Ne as default};
