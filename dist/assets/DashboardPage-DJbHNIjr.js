import{u as P,d as L,C as w,I as E,Q,a as I,b as U,r as C,c as N,e as y,F as b,f as s,g as n,_ as $,w as T,h as j,i as u,o as c,j as B,k as z,l as x,m as A,n as k,p as h,t as f,q as i,s as D,v as K,x as H,y as R,z as G,A as V,B as S}from"./index-CsSPZm9O.js";import{_ as Z,a as F,T as M,b as q,c as J,F as W}from"./FloatingBar-CWZ6kd2D.js";async function X(a){try{return(await L.listDocuments(w.DATABASE_ID,w.COLLECTIONS.INCOME,[Q.equal("propertyId",a)])).documents}catch(o){throw console.log("error fetching incomes"),o}}async function Y(a){var r;const d=(r=P().currentUser)==null?void 0:r.$id;try{return await L.createDocument(w.DATABASE_ID,w.COLLECTIONS.INCOME,E.unique(),{...a,propertyId:d})}catch(t){console.log(t)}}const ee={class:"fieldset w-full"},te=I({__name:"AddIncomeForm",emits:["on-add-income"],setup(a,{emit:o}){const d=U(),r=o,t=C({propertyId:"",type:"",amount:0,datePaid:""}),{mutate:p,isPending:m}=N({mutationFn:Y,onSuccess:()=>{d.invalidateQueries({queryKey:["incomes"]})}}),_=()=>{p(t.value),r("on-add-income")};return(v,e)=>(c(),y(b,null,[s("form",{onSubmit:T(_,["prevent"]),class:"flex justify-center align-center items-center"},[s("fieldset",ee,[n($,{modelValue:t.value.type,"onUpdate:modelValue":e[0]||(e[0]=l=>t.value.type=l),label:"Type",placeholder:"Type of income"},null,8,["modelValue"]),n($,{modelValue:t.value.amount,"onUpdate:modelValue":e[1]||(e[1]=l=>t.value.amount=l),label:"Amount",placeholder:"Amount",type:"number"},null,8,["modelValue"]),n(Z,{label:"Date paid",modelValue:t.value.datePaid,"onUpdate:modelValue":e[2]||(e[2]=l=>t.value.datePaid=l),type:"month"},null,8,["modelValue"]),e[3]||(e[3]=s("div",{class:"flex w-full justify-end gap-2 mt-2"},[s("button",{type:"submit",class:"btn btn-primary"}," Add income ")],-1))])],32),n(j,{"is-loading":u(m)},null,8,["is-loading"])],64))}}),ne={},se={xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"size-12"};function oe(a,o){return c(),y("svg",se,o[0]||(o[0]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M2.25 8.25h19.5M2.25 9h19.5m-16.5 5.25h6m-6 2.25h3m-3.75 3h15a2.25 2.25 0 0 0 2.25-2.25V6.75A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25v10.5A2.25 2.25 0 0 0 4.5 19.5Z"},null,-1)]))}const ae=B(ne,[["render",oe]]);function le(a){return z({queryKey:["incomes",a],queryFn:()=>X(a),enabled:x(()=>!!a),staleTime:1e3*60*5})}const re={},ie={class:"card bg-base-100 shadow-sm mb-4 border-2 border-white/20"},de={class:"card-body"},ue={class:"card-title"},ce={class:"card-actions justify-end"};function me(a,o){return c(),y("div",ie,[s("div",de,[s("h2",ue,[A(a.$slots,"title")]),A(a.$slots,"default"),s("div",ce,[A(a.$slots,"actions")])])])}const O=B(re,[["render",me]]),pe={class:"title text-2xl mb-4"},_e=I({__name:"ListIncomes",setup(a){const o=P(),d=x(()=>{var m;return((m=o.currentUser)==null?void 0:m.$id)||""}),{data:r,isPending:t}=le(d.value),{t:p}=k();return(m,_)=>(c(),y(b,null,[s("h1",pe,f(u(p)("incomes.list")),1),u(t)?(c(),h(M,{key:0})):(c(),h(F,{key:1,class:"gap-4"},{default:i(()=>[(c(!0),y(b,null,D(u(r),v=>(c(),h(q,{key:v.datePaid,size:12,responsive:{sm:12,md:6,lg:6}},{default:i(()=>[n(O,null,{default:i(()=>[n(J,{title:u(p)(`incomes.categories.${v.type.toLowerCase()}`),value:v.amount},{image:i(()=>[n(ae)]),_:2},1032,["title","value"])]),_:2},1024)]),_:2},1024))),128))]),_:1}))],64))}}),fe={class:"fieldset w-full"},ye=I({__name:"AddPropertyForm",emits:["on-add-property"],setup(a,{emit:o}){const d=U(),r=o,t=C({name:"",location:"",ownerId:"",units:0}),{mutate:p,isPending:m}=N({mutationFn:K,onSuccess:()=>{d.invalidateQueries({queryKey:["ownerId"]})}}),_=()=>{p(t.value),r("on-add-property")};return(v,e)=>(c(),y(b,null,[s("form",{onSubmit:T(_,["prevent"]),class:"flex justify-center align-center items-center"},[s("fieldset",fe,[n($,{modelValue:t.value.name,"onUpdate:modelValue":e[0]||(e[0]=l=>t.value.name=l),label:"Name",placeholder:"Name"},null,8,["modelValue"]),n($,{modelValue:t.value.location,"onUpdate:modelValue":e[1]||(e[1]=l=>t.value.location=l),label:"Street name",placeholder:"Location"},null,8,["modelValue"]),n($,{modelValue:t.value.units,"onUpdate:modelValue":e[2]||(e[2]=l=>t.value.units=l),type:"number",label:"Units (How many units this property have?)",placeholder:"How many units this property have?"},null,8,["modelValue"]),e[3]||(e[3]=s("div",{class:"flex w-full justify-end gap-2 mt-2"},[s("button",{type:"submit",class:"btn btn-primary"}," Add property "),s("button",{class:"btn btn-soft"}," Cancel ")],-1))])],32),n(j,{"is-loading":u(m)},null,8,["is-loading"])],64))}}),ve={class:"title text-2xl mb-4"},be={class:"join mt-2"},ge=I({__name:"ListProperties",props:{isPresentational:{type:Boolean,default:!1}},setup(a){var _;const o=P(),{data:d,isPending:r}=H("ownerId",((_=o.currentUser)==null?void 0:_.$id)??""),{t}=k(),p=a,m=x(()=>p.isPresentational?{sm:12,md:12,lg:12}:{sm:12,md:6,lg:4});return(v,e)=>{const l=R("RouterLink");return c(),y(b,null,[s("h1",ve,f(u(t)("properties.added")),1),n(F,{class:"gap-4"},{default:i(()=>[(c(!0),y(b,null,D(u(d),g=>(c(),h(q,{key:g.$id,size:12,responsive:m.value},{default:i(()=>[u(r)?(c(),h(M,{key:0})):G("",!0),n(O,null,{title:i(()=>[V(f(g.name),1)]),actions:i(()=>[A(v.$slots,"property-actions",{},()=>[s("div",be,[n(l,{to:`/property-categories/${g.$id}`,class:"btn btn-outline btn-sm join-item"},{default:i(()=>e[0]||(e[0]=[V(" Configure categories ")])),_:2,__:[0]},1032,["to"]),n(l,{to:`/property-details/${g.$id}`,class:"btn btn-outline btn-sm join-item"},{default:i(()=>[V(f(u(t)("expenses.check")),1)]),_:2},1032,["to"])])])]),default:i(()=>[s("ul",null,[s("li",null,f(u(t)("location"))+": "+f(g.location),1)])]),_:2},1024)]),_:2},1032,["responsive"]))),128))]),_:3})],64)}}}),$e={class:"title text-2xl"},Ie=I({__name:"DashboardPage",setup(a){const{t:o}=k(),d=C(!1),r=C(!1),t=()=>d.value=!0,p=()=>d.value=!1,m=()=>r.value=!0,_=()=>r.value=!1;return(v,e)=>(c(),y(b,null,[s("h1",$e,f(u(o)("dashboard")),1),e[2]||(e[2]=s("div",{class:"divider"},null,-1)),n(ge),e[3]||(e[3]=s("div",{class:"divider"},null,-1)),n(_e),n(W,{actions:[{name:"property"},{name:"income"}],onProperty:t,onIncome:m},{property:i(()=>[V(f(u(o)("properties.add")),1)]),income:i(()=>[V(f(u(o)("income.add")),1)]),_:1}),n(S,{title:"Add Property",modelValue:d.value,"onUpdate:modelValue":e[0]||(e[0]=l=>d.value=l)},{default:i(()=>[n(ye,{onOnAddProperty:p})]),_:1},8,["modelValue"]),n(S,{title:"Add Income",modelValue:r.value,"onUpdate:modelValue":e[1]||(e[1]=l=>r.value=l)},{default:i(()=>[n(te,{onOnAddIncome:_})]),_:1},8,["modelValue"])],64))}});export{Ie as default};
