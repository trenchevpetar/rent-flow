import{d as x,C as I,u as E,I as H,Q as G,a as g,c as b,w as Y,b as r,r as C,o as m,t as p,e as N,f as P,g as B,F as D,h as n,i as d,_ as w,j as F,k as i,l as U,m as S,n as Z,p as L,q as J,s as O,v as V,x as j,y as W,z as X,A as ee,B as A,D as T}from"./index-BKw20bMb.js";import{_ as te,a as M,T as q,b as Q,c as ne,u as oe,d as se,F as ae}from"./FloatingBar-B0O_yLDU.js";async function le(a){try{return(await x.listDocuments(I.DATABASE_ID,I.COLLECTIONS.INCOME,[G.equal("propertyId",a)])).documents}catch(e){throw console.log("error fetching incomes"),e}}async function ie(a){var l;const o=(l=E().currentUser)==null?void 0:l.$id;try{return await x.createDocument(I.DATABASE_ID,I.COLLECTIONS.INCOME,H.unique(),{...a,propertyId:o})}catch(t){console.log(t)}}async function re(a){try{await x.deleteDocument(I.DATABASE_ID,I.COLLECTIONS.INCOME,a)}catch(e){throw console.log(`Error deleting income with id: ${a}`),e}}const ce={class:"fieldset w-full"},de={class:"flex w-full justify-end gap-2 mt-2"},ue={type:"submit",class:"btn btn-primary"},z=g({__name:"BasicForm",props:{submitLabel:{},cancelLabel:{}},emits:["on-submit","on-cancel"],setup(a,{emit:e}){const o=e,l=()=>o("on-submit"),t=()=>o("on-cancel");return(u,_)=>(m(),b("form",{onSubmit:Y(l,["prevent"]),class:"flex justify-center align-center items-center"},[r("fieldset",ce,[C(u.$slots,"default"),r("div",de,[C(u.$slots,"actions",{},()=>[r("button",ue,p(u.submitLabel),1),r("button",{type:"reset",class:"btn btn-soft",onClick:t},p(u.cancelLabel),1)])])])],32))}}),me=g({__name:"AddIncomeForm",emits:["on-add-income","on-cancel"],setup(a,{emit:e}){const o=N(),l=e,t=P({propertyId:"",type:"",amount:0,datePaid:""}),{mutate:u,isPending:_}=B({mutationFn:ie,onSuccess:()=>{o.invalidateQueries({queryKey:["incomes"]})}}),f=()=>{u(t.value),l("on-add-income")},v=()=>l("on-cancel");return(h,c)=>(m(),b(D,null,[n(z,{"submit-label":"Add Income","cancel-label":"Cancel",onOnSubmit:f,onOnCancel:v},{default:d(()=>[n(w,{modelValue:t.value.type,"onUpdate:modelValue":c[0]||(c[0]=s=>t.value.type=s),label:"Type",placeholder:"Type of income"},null,8,["modelValue"]),n(w,{modelValue:t.value.amount,"onUpdate:modelValue":c[1]||(c[1]=s=>t.value.amount=s),label:"Amount",placeholder:"Amount",type:"number"},null,8,["modelValue"]),n(te,{label:"Date paid",modelValue:t.value.datePaid,"onUpdate:modelValue":c[2]||(c[2]=s=>t.value.datePaid=s),type:"month"},null,8,["modelValue"])]),_:1}),n(F,{"is-loading":i(_)},null,8,["is-loading"])],64))}}),pe={},_e={xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"size-12"};function fe(a,e){return m(),b("svg",_e,e[0]||(e[0]=[r("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M2.25 8.25h19.5M2.25 9h19.5m-16.5 5.25h6m-6 2.25h3m-3.75 3h15a2.25 2.25 0 0 0 2.25-2.25V6.75A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25v10.5A2.25 2.25 0 0 0 4.5 19.5Z"},null,-1)]))}const ye=U(pe,[["render",fe]]),be={class:"join"},he=g({__name:"ListIncomeActions",emits:["on-edit","on-delete"],setup(a,{emit:e}){const o=e,{t:l}=S(),t=()=>o("on-edit"),u=()=>o("on-delete");return(_,f)=>(m(),b("div",be,[r("button",{class:"btn btn-info btn-xs join-item",onClick:t},p(i(l)("actions.edit")),1),r("button",{class:"btn btn-error btn-xs join-item",onClick:u},p(i(l)("actions.delete")),1)]))}});function ve(a){const e=Z({queryKey:["incomes",a],queryFn:()=>le(a),enabled:L(()=>!!a),staleTime:3e5});return{...e,refresh:()=>e.refetch()}}const ge={},$e={class:"card bg-base-100 shadow-sm mb-4 border-2 border-white/20"},Ce={class:"card-body"},Ie={class:"card-title"},we={class:"card-actions justify-end"};function Ve(a,e){return m(),b("div",$e,[r("div",Ce,[r("h2",Ie,[C(a.$slots,"title")]),C(a.$slots,"default"),r("div",we,[C(a.$slots,"actions")])])])}const K=U(ge,[["render",Ve]]),Ae={key:0,class:"list-incomes"},De={class:"title text-2xl mb-4"},Pe={class:"flex gap-2"},Se={class:"badge badge-info badge-dash"},ke={class:"badge badge-success badge-dash"},Oe=g({__name:"ListIncomes",emits:["on-edit-income"],setup(a,{emit:e}){const o=J(),l=e,t=E(),u=L(()=>{var y;return((y=t.currentUser)==null?void 0:y.$id)||""}),{data:_,isPending:f,refetch:v}=ve(u.value),{t:h}=S(),c=y=>l("on-edit-income",y),s=async y=>{await se({title:"Confirm deletion",message:"Are you sure you want to delete this income?",onConfirm:async()=>{await re(y.$id),v()}})?await o.show("Deleted successfully","success"):await o.show("Deletion failed, try again later","warning")};return(y,k)=>i(_)&&i(_).length?(m(),b("section",Ae,[r("h1",De,p(i(h)("incomes.list")),1),i(f)?(m(),V(q,{key:0})):(m(),V(M,{key:1,class:"gap-4"},{default:d(()=>[(m(!0),b(D,null,j(i(_),$=>(m(),V(Q,{key:$.datePaid,size:12,responsive:{sm:12,md:6,lg:6}},{default:d(()=>[n(K,null,{default:d(()=>[n(ne,{value:$.amount},{title:d(()=>[r("div",Pe,[r("div",Se," TYPE: "+p($.type),1),r("div",ke," RECEIVED: "+p(i(oe)($.datePaid)),1)])]),image:d(()=>[n(ye)]),actions:d(()=>[n(he,{onOnDelete:R=>s($),onOnEdit:R=>c($)},null,8,["onOnDelete","onOnEdit"])]),_:2},1032,["value"])]),_:2},1024)]),_:2},1024))),128))]),_:1})),k[0]||(k[0]=r("div",{class:"divider"},null,-1))])):O("",!0)}}),xe=g({__name:"AddPropertyForm",emits:["on-add-property","on-cancel"],setup(a,{emit:e}){const o=N(),l=e,t=P({name:"",location:"",ownerId:"",units:0}),{mutate:u,isPending:_}=B({mutationFn:W,onSuccess:()=>{o.invalidateQueries({queryKey:["ownerId"]})}}),f=()=>{u(t.value),l("on-add-property")},v=()=>l("on-cancel");return(h,c)=>(m(),b(D,null,[n(z,{"submit-label":"Add property","cancel-label":"Cancel",onOnSubmit:f,onOnCancel:v},{default:d(()=>[n(w,{modelValue:t.value.name,"onUpdate:modelValue":c[0]||(c[0]=s=>t.value.name=s),label:"Name",placeholder:"Name"},null,8,["modelValue"]),n(w,{modelValue:t.value.location,"onUpdate:modelValue":c[1]||(c[1]=s=>t.value.location=s),label:"Street name",placeholder:"Location"},null,8,["modelValue"]),n(w,{modelValue:t.value.units,"onUpdate:modelValue":c[2]||(c[2]=s=>t.value.units=s),type:"number",label:"Units (How many units this property have?)",placeholder:"How many units this property have?"},null,8,["modelValue"])]),_:1}),n(F,{"is-loading":i(_)},null,8,["is-loading"])],64))}}),Ee={key:0,class:"list-properties"},Le={class:"title text-2xl mb-4"},Te={class:"join mt-2"},Ne=g({__name:"ListProperties",props:{isPresentational:{type:Boolean,default:!1}},setup(a){var f;const e=E(),{data:o,isPending:l}=X("ownerId",((f=e.currentUser)==null?void 0:f.$id)??""),{t}=S(),u=a,_=L(()=>u.isPresentational?{sm:12,md:12,lg:12}:{sm:12,md:6,lg:4});return(v,h)=>{const c=ee("RouterLink");return i(o)&&i(o).length?(m(),b("section",Ee,[r("h1",Le,p(i(t)("properties.added")),1),n(M,{class:"gap-4"},{default:d(()=>[(m(!0),b(D,null,j(i(o),s=>(m(),V(Q,{key:s.$id,size:12,responsive:_.value},{default:d(()=>[i(l)?(m(),V(q,{key:0})):O("",!0),n(K,null,{title:d(()=>[A(p(s.name),1)]),actions:d(()=>[C(v.$slots,"property-actions",{},()=>[r("div",Te,[n(c,{to:`/property-categories/${s.$id}`,class:"btn btn-outline btn-sm join-item"},{default:d(()=>h[0]||(h[0]=[A(" Configure categories ")])),_:2,__:[0]},1032,["to"]),n(c,{to:`/property-details/${s.$id}`,class:"btn btn-outline btn-sm join-item"},{default:d(()=>[A(p(i(t)("expenses.check")),1)]),_:2},1032,["to"])])])]),default:d(()=>[r("ul",null,[r("li",null,p(i(t)("location"))+": "+p(s.location),1)])]),_:2},1024)]),_:2},1032,["responsive"]))),128))]),_:3}),h[1]||(h[1]=r("div",{class:"divider"},null,-1))])):O("",!0)}}}),Be={class:"title text-2xl mb-4"},je=g({__name:"DashboardPage",setup(a){const{t:e}=S(),o=P(!1),l=P(!1),t=()=>o.value=!0,u=()=>o.value=!1,_=()=>o.value=!1,f=()=>l.value=!0,v=()=>l.value=!1,h=()=>l.value=!1;return(c,s)=>(m(),b(D,null,[r("h1",Be,p(i(e)("dashboard")),1),n(Ne),n(Oe),n(ae,{actions:[{name:"property"},{name:"income"}],onProperty:t,onIncome:f},{property:d(()=>[A(p(i(e)("properties.add")),1)]),income:d(()=>[A(p(i(e)("income.add")),1)]),_:1}),n(T,{title:i(e)("properties.add"),modelValue:o.value,"onUpdate:modelValue":s[0]||(s[0]=y=>o.value=y)},{default:d(()=>[n(xe,{onOnCancel:_,onOnAddProperty:u})]),_:1},8,["title","modelValue"]),n(T,{title:i(e)("income.add"),modelValue:l.value,"onUpdate:modelValue":s[1]||(s[1]=y=>l.value=y)},{default:d(()=>[n(me,{onOnCancel:h,onOnAddIncome:v})]),_:1},8,["title","modelValue"])],64))}});export{je as default};
